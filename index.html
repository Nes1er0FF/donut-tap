<!DOCTYPE html>
<html>
<head>
    <title>Donut Tap v0.8</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <style>
        body { 
            background: #418CD8FF;
            color: #000000;
            font-family: monospace;
            text-align: center;
            padding: 0;
            overflow: hidden;
            margin: 0;
        }
        #score {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            font-size: 2rem;
            margin: 20px 0 0 0;
        }
        #donut-icon {
            width: 64px;
            height: 64px;
            image-rendering: pixelated;
        }
        #donut {
            background: url('./images/donut_sprite.png') center/contain no-repeat;
            width: 300px;
            height: 300px;
            position: fixed;
            top: 55%;
            left: 50%;
            transform: translate(-50%, -50%);
            image-rendering: pixelated;
            cursor: pointer;
            -webkit-tap-highlight-color: transparent;
            touch-action: manipulation;
        }
        
        /* –ö–Ω–æ–ø–∫–∞ —Å–±—Ä–æ—Å–∞ */
        #reset-btn {
            position: fixed;
            top: 20px;
            left: 20px;
            width: 100px;
            height: 100px;
            cursor: pointer;
            z-index: 3000;
            image-rendering: pixelated;
            border: none;
            background: none;
            outline: none;
            -webkit-tap-highlight-color: transparent;
        }
        
        /* –°—Ç–∏–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–∫ */
        #settings-btn {
            position: fixed;
            top: 20px;
            right: 20px;
            width: 50px;
            height: 50px;
            cursor: pointer;
            z-index: 1000;
            image-rendering: pixelated;
        }
        
        /* –ù–û–í–´–ï –ö–ù–û–ü–ö–ò –í–ù–ò–ó–£ - –£–ë–ò–†–ê–ï–ú INFO –û–¢–°–Æ–î–ê */
        .bottom-btn {
            position: fixed;
            bottom: 20px;
            width: 50px;
            height: 50px;
            cursor: pointer;
            z-index: 1000;
            image-rendering: pixelated;
            -webkit-tap-highlight-color: transparent;
        }
        
        #upgrades-btn { 
            left: 20px; 
        }
        
        /* –£–ë–†–ê–ù–ê #info-btn –∏–∑ –≥–ª–∞–≤–Ω–æ–≥–æ —ç–∫—Ä–∞–Ω–∞ */
        
        /* –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ (–æ–±—â–∏–µ —Å—Ç–∏–ª–∏) */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.7);
            z-index: 2000;
        }
        
        .modal-window {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            image-rendering: pixelated;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }
        
        /* –†–ê–ó–î–ï–õ–¨–ù–´–ï –§–û–ù–´ –î–õ–Ø –ú–ï–ù–Æ */
        #settings-window {
            background: url('images/settings_background.png') center/contain no-repeat;
            width: 300px;
            height: 200px;
            
        }
        
        #upgrades-window {
            background: none !important;
            width: 280px;
            min-height: 350px;
            max-height: 80vh;
            overflow-y: auto;
            position: relative;
            z-index: 2001;
            margin-top: 20px;
        /* –î–æ–±–∞–≤–ª—è–µ–º –≤–µ—Ä—Ö–Ω–∏–π –æ—Ç—Å—Ç—É–ø –¥–ª—è –ø–µ—Ä–≤–æ–π –∫–∞—Ä—Ç–æ—á–∫–∏ */
            padding-top: 20px;
        }

        #upgrades-list {
            width: 100%;
            margin-top: 0; /* –£–±–∏—Ä–∞–µ–º –ª–∏—à–Ω–∏–π –æ—Ç—Å—Ç—É–ø */
        }

        /* –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è –≤—Å–µ—Ö –∫–∞—Ä—Ç–æ—á–µ–∫ */
        .upgrade-item {
            display: flex;
            align-items: center;
            padding: 12px; /* –ù–µ–º–Ω–æ–≥–æ —É–≤–µ–ª–∏—á–∏–≤–∞–µ–º –æ—Ç—Å—Ç—É–ø—ã */
            margin: 10px auto; /* –¶–µ–Ω—Ç—Ä–∏—Ä—É–µ–º –∏ –¥–æ–±–∞–≤–ª—è–µ–º –æ—Ç—Å—Ç—É–ø—ã */
            background: rgba(255,255,255,0.15);
            border: 2px solid rgba(255,255,255,0.3);
            border-radius: 8px;
            cursor: pointer;
            width: 95%;
            box-sizing: border-box;
            transition: all 0.2s ease;
            position: relative;
            z-index: 2002;
        }

        /* –ü–µ—Ä–≤–∞—è –∫–∞—Ä—Ç–æ—á–∫–∞ (–ø–æ–≤–∞—Ä) –º–æ–∂–µ—Ç –∏–º–µ—Ç—å –æ—Å–æ–±—ã–π —Å—Ç–∏–ª—å */
        .upgrade-item:first-of-type {
            border-color: gold;
            background: rgba(255, 215, 0, 0.1);
            box-shadow: 0 0 15px rgba(255, 215, 0, 0.3);
        }
        
        /* –ü–û–õ–ù–û–≠–ö–†–ê–ù–ù–´–ô –ë–ï–ö–ì–†–ê–£–ù–î –î–õ–Ø –£–õ–£–ß–®–ï–ù–ò–ô */
        #upgrades-fullscreen-bg {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 550px;
            height: 600px;
            background: url('images/upgrades_background.png') center/100% 100% no-repeat;
            image-rendering: pixelated;
            z-index: 1999;
        }
        
        /* –î–µ–ª–∞–µ–º –∑–∞—Ç–µ–º–Ω–µ–Ω–∏–µ –º–æ–¥–∞–ª–∫–∏ –º–µ–Ω–µ–µ —Ç—ë–º–Ω—ã–º */
        #upgrades-modal.modal {
            background: rgba(0, 0, 0, 0.5);
        }

        /*–Ω–æ–≤—ã–π –±–ª–æ–∫ –∫–Ω–æ–ø–∫–∏ reset –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö*/
        #reset-container {
            margin-top: 20px; /* –ù–∞—á–∞–ª—å–Ω–∞—è –ø–æ–∑–∏—Ü–∏—è */
            text-align: center;
        }

        #reset-btn-settings {
            width: 100px;
            height: 100px;
            cursor: pointer;
            image-rendering: pixelated;
        }
        /*–æ—Ç–¥–µ–ª—å–Ω–æ–µ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–ª–æ–∂–µ–Ω–∏—è –∫–Ω–æ–ø–æ–∫ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö*/
        #music-setting { margin-top: 165px; }
        #sound-setting { margin-top: 20px; }
        #reset-container { margin-top: 30px; }
        
        /* –°–ú–ï–©–ê–ï–ú –ò–ö–û–ù–ö–£ –ú–£–ó–´–ö–ò –í–ü–†–ê–í–û */
        #music-icon {
            margin-left: 14px;
        }
        
        /* –°–µ–∫—Ü–∏—è —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π - –¢–û–õ–¨–ö–û –î–õ–Ø –£–õ–£–ß–®–ï–ù–ò–ô */
        .info-section {
            position: fixed;
            right: 20px;
            bottom: 260px;
            display: flex;
            align-items: flex-start;
            gap: 10px;
            z-index: 2003;
        }

        .info-text {
            position: absolute;
            right: 60px;
            top: -150px;
            width: 200px;
            background: rgba(0, 0, 0, 0.9);
            color: white;
            padding: 10px;
            border-radius: 8px;
            font-size: 14px;
            text-align: left;
            z-index: 2004;
            border: 2px solid rgba(255, 255, 255, 0.3);
        }
        
        /* Info-–∫–Ω–æ–ø–∫–∞ - –¢–û–õ–¨–ö–û –î–õ–Ø –£–õ–£–ß–®–ï–ù–ò–ô */
        .info-btn {
            width: 27px;
            height: 27px;
            cursor: pointer;
            image-rendering: pixelated;
            -webkit-tap-highlight-color: transparent;
            transition: transform 0.1s ease;
        }

        .info-btn:active {
            transform: scale(0.95);
        }
        
        .close-icon {
            position: absolute;
            top: 15px;
            right: 15px;
            width: 24px;
            height: 24px;
            cursor: pointer;
            image-rendering: pixelated;
        }
        
        .setting-row {
            display: flex;
            align-items: center;
            gap: 15px;
            margin: 15px 0;
            color: white;
            font-size: 20px;
            cursor: pointer;
            image-rendering: pixelated;
        }
        
        .setting-icon {
            width: 32px;
            height: 32px;
            image-rendering: pixelated;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è —É–ª—É—á—à–µ–Ω–∏–π */
        .upgrade-item {
            display: flex;
            align-items: center;
            padding: 8px;
            margin: 8px 0;
            background: rgba(255,255,255,0.15);
            border: 2px solid rgba(255,255,255,0.3);
            border-radius: 6px;
            cursor: pointer;
            width: 95%;
            box-sizing: border-box;
            transition: all 0.2s ease;
            position: relative;
            z-index: 2002;
        }

        .upgrade-item:hover {
            background: rgba(255,255,255,0.25);
            transform: translateY(-2px);
        }

        .upgrade-item:active {
            transform: scale(0.98);
        }

        .upgrade-icon {
            width: 48px;
            height: 48px;
            image-rendering: pixelated;
            flex-shrink: 0;
        }

        .upgrade-info {
            flex-grow: 1;
            margin-left: 12px;
            text-align: left;
            color: white;
        }

        .upgrade-title {
            font-weight: bold;
            font-size: 18px;
            margin-bottom: 4px;
        }

        .upgrade-description {
            font-size: 14px;
            opacity: 0.8;
            margin-bottom: 4px;
        }

        .upgrade-price {
            font-size: 14px;
            color: #ffd700;
        }

        .upgrade-status {
            font-size: 16px;
            color: #90ee90;
            flex-shrink: 0;
            margin-left: 10px;
            font-weight: bold;
        }
         
        }
        /* –∫–Ω–æ–ø–∫–∞ —É–ª—É—á—à–µ–Ω–∏–π –≤ –º–∞—Ä–∫–µ—Ç–µ*/
        .upgrades-action-btn {
            position: absolute;
            bottom: 20px;
            right: 20px;
            width: 60px;
            height: 60px;
            cursor: pointer;
        }
      
        /* –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å–ø–∏—Å–∫–∞ —É–ª—É—á—à–µ–Ω–∏–π */
        #upgrades-list {
            width: 100%;
            margin-top: 40px;
        }

        /* –°–¢–ò–õ–ò –î–õ–Ø –ú–ê–†–ö–ï–¢–ê –ö–ê–†–¢–û–ß–ï–ö */
        #card-upgrades-layer {
            width: 100%;
            margin-top: 40px;
            color: white;
            text-align: center;
        }

        .market-title {
            font-size: 24px;
            margin-bottom: 20px;
            color: #ffd700;
        }

        .coming-soon {
            font-size: 18px;
            opacity: 0.8;
            margin-top: 50px;
        }

        /* –ê–Ω–∏–º–∞—Ü–∏–∏ */
        @keyframes jump {
            0% { transform: translate(-50%, -50%) scale(1); }
            50% { transform: translate(-50%, -60%) scale(1.1); }
            100% { transform: translate(-50%, -50%) scale(1); }
        }
        
        .jump-animation {
            animation: jump 0.3s ease-in-out;
        }
        
        #particles-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 100;
        }
        
        .particle {
            position: absolute;
            width: 32px;
            height: 32px;
            background-size: contain;
            background-repeat: no-repeat;
            image-rendering: pixelated;
            transition: transform 0.5s ease-out, opacity 0.5s ease-out;
            opacity: 1;
        }

        /* –£–±–∏—Ä–∞–µ–º —Å–∏–Ω—é—é –ø–æ–¥—Å–≤–µ—Ç–∫—É –ø—Ä–∏ —Ç–∞–ø–µ */
        #settings-btn, 
        .bottom-btn,
        .close-icon,
        .setting-row,
        .setting-icon,
        .upgrade-item,
        .info-btn {
            -webkit-tap-highlight-color: transparent;
            tap-highlight-color: transparent;
            outline: none;
            -webkit-user-select: none;
            user-select: none;
        }

        .setting-row:active,
        .upgrade-item:active {
            transform: scale(0.95);
        }

        /* === –°–ò–°–¢–ï–ú–ê –°–õ–û–ï–í === */
        .game-layer {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        z-index: 1000;
        }

        /* –ì–õ–ê–í–ù–´–ô –°–õ–û–ô (–≤—Å–µ–≥–¥–∞ –≤–∏–¥–∏–º) */
        #main-layer {
            z-index: 1000;
        }

        /* –°–õ–û–ô –£–õ–£–ß–®–ï–ù–ò–ô */
        #upgrades-layer {
            z-index: 2000;
            display: none; /* –ò–∑–Ω–∞—á–∞–ª—å–Ω–æ —Å–∫—Ä—ã—Ç */
        }

        /* –£–ë–ò–†–ê–ï–ú –°–¢–ê–†–´–ï –°–¢–ò–õ–ò –ú–û–î–ê–õ–û–ö */
        #upgrades-modal.modal {
            display: none; /* –û—Ç–∫–ª—é—á–∞–µ–º —Å—Ç–∞—Ä—ã–π —Å—Ç–∏–ª—å */
        }

        /* –£–±–∏—Ä–∞–µ–º —Å–∏–Ω—é—é –ø–æ–¥—Å–≤–µ—Ç–∫—É –ø—Ä–∏ —Ç–∞–ø–µ –Ω–∞ –∫–Ω–æ–ø–∫—É —É–ª—É—á—à–µ–Ω–∏–π */
        #open-upgrades-btn {
          -webkit-tap-highlight-color: transparent;
          tap-highlight-color: transparent;
          outline: none;
          -webkit-user-select: none;
          user-select: none;
        }

        /* –£–±–∏—Ä–∞–µ–º —Å–∏–Ω—é—é –ø–æ–¥—Å–≤–µ—Ç–∫—É –ø—Ä–∏ —Ç–∞–ø–µ –Ω–∞ –∫–Ω–æ–ø–∫—É —Å–±—Ä–æ—Å–∞ */
        #reset-btn-settings {
          -webkit-tap-highlight-color: transparent;
          tap-highlight-color: transparent;
          outline: none;
          -webkit-user-select: none;
          user-select: none;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è ID –∏–≥—Ä–æ–∫–∞ */
        #player-id-setting {
          margin-top: 10px;
          padding: 15px 0; /* –¢–æ–ª—å–∫–æ –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–µ –æ—Ç—Å—Ç—É–ø—ã */
          text-align: center;
        }

        .clickable-id {
          font-family: 'Courier New', monospace;
          font-weight: bold;
          font-size: 18px;
          color: #FFD700; /* –ó–æ–ª–æ—Ç–æ–π —Ü–≤–µ—Ç */
          padding: 8px 16px;
          border-radius: 6px;
          display: inline-block;
          min-width: 160px;
          text-align: center;
          cursor: pointer;
          transition: all 0.2s ease;
          user-select: none;
          background: none; /* –ë–µ–∑ —Ñ–æ–Ω–∞ */
          border: none; /* –ë–µ–∑ –æ–±–≤–æ–¥–∫–∏ */
          text-shadow: 0 0 10px rgba(255, 215, 0, 0.5); /* –õ–µ–≥–∫–æ–µ —Å–≤–µ—á–µ–Ω–∏–µ */
        }

        /* –≠—Ñ—Ñ–µ–∫—Ç –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏ - —Ç–æ–ª—å–∫–æ —Å–≤–µ—á–µ–Ω–∏–µ */
        .clickable-id:hover {
          transform: translateY(-1px);
          text-shadow: 0 0 15px rgba(255, 215, 0, 0.8); /* –£—Å–∏–ª–∏–≤–∞–µ–º —Å–≤–µ—á–µ–Ω–∏–µ */
        }

        .clickable-id:active {
          transform: translateY(0);
        }

        /* –ê–Ω–∏–º–∞—Ü–∏—è –ø—Ä–∏ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–∏ - —Ç–æ–ª—å–∫–æ –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Ü–≤–µ—Ç–∞ */
@keyframes copyFlash {
    0% { 
        color: #FFD700;
        text-shadow: 0 0 10px rgba(255, 215, 0, 0.5);
    }
    50% { 
        color: #4CAF50; /* –ó–µ–ª–µ–Ω—ã–π –ø—Ä–∏ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–∏ */
        text-shadow: 0 0 15px rgba(76, 175, 80, 0.7);
    }
    100% { 
        color: #FFD700;
        text-shadow: 0 0 10px rgba(255, 215, 0, 0.5);
    }
}

.copied-animation {
    animation: copyFlash 0.8s ease;
}

/* –£–±–∏—Ä–∞–µ–º –í–°–ï –ø–æ–¥—Å–∫–∞–∑–∫–∏ */
.clickable-id::after {
    display: none;
}

#player-id-setting::before {
    display: none; /* –£–±–∏—Ä–∞–µ–º –ø–æ–¥—Å–∫–∞–∑–∫—É –ø–æ–ª–Ω–æ—Å—Ç—å—é */
}
        
    </style>
</head>
<body>
    <!-- –∑–¥–µ—Å—å –±–Ω–æ–ø–∫–∞ —Å–±—Ä–æ—Å–∞ -->
    
    
    <div id="score">
        <img id="donut-icon" src="images/mini_donut.png" alt="üç©">
        <span id="score-text">0</span>
    </div>
    
    <div id="donut"></div>
    <div id="particles-container"></div>
    
    <!-- –ö–Ω–æ–ø–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫ -->
    <img id="settings-btn" src="images/settings_icon.png" alt="‚öôÔ∏è">
    
    <!-- –ö–ù–û–ü–ö–ò –í–ù–ò–ó–£ - –¢–û–õ–¨–ö–û UPGRADES -->
    <img id="upgrades-btn" src="images/upgrades_icon.png" class="bottom-btn" alt="üõ†Ô∏è">
    
    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –Ω–∞—Å—Ç—Ä–æ–µ–∫ -->
    <div id="settings-modal" class="modal">
        <div id="settings-window" class="modal-window">
            <img id="close-btn" src="images/close_icon.png" class="close-icon" alt="‚úï">
            
            <div class="setting-row" id="music-setting">
                <img id="music-icon" src="images/music_on.png" class="setting-icon" alt="üéµ">
                <span>–ú—É–∑—ã–∫–∞</span>
            </div>
            
            <div class="setting-row" id="sound-setting">
                <img id="sound-icon" src="images/sound_on.png" class="setting-icon" alt="üîä">
                <span>–ó–≤—É–∫–∏</span>
            </div>
      
            <div class="setting-row" id="player-id-setting">
                <span id="player-id-display" class="clickable-id">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
            </div>
            
            <!-- –ó–ê–ú–ï–ù–Ø–ï–ú —Å—Ç–∞—Ä—ã–π reset-setting –Ω–∞ –Ω–æ–≤—ã–π –±–ª–æ–∫ -->
            <div id="reset-container">
                 <img id="reset-btn-settings" src="images/reset_button.png" alt="üîÑ –°–±—Ä–æ—Å">
            </div>
        </div>   
    </div>
    

    <!-- –ù–û–í–´–ô –ö–û–î - –°–õ–û–ô –£–õ–£–ß–®–ï–ù–ò–ô -->
<div id="upgrades-layer" class="game-layer" style="display: none;">
    <!-- –ü–û–õ–ù–û–≠–ö–†–ê–ù–ù–´–ô –ë–ï–ö–ì–†–ê–£–ù–î -->
    <div id="upgrades-fullscreen-bg"></div>
    
    <div id="upgrades-window" class="modal-window">
        <img id="close-upgrades" src="images/close_icon.png" class="close-icon" alt="‚úï">
        
        <!-- –°–õ–û–ô 1: –£–õ–£–ß–®–ï–ù–ò–Ø -->
        <div id="upgrades-list">
            <!-- –ö–∞—Ä—Ç–æ—á–∫–∞ –ø–æ–≤–∞—Ä–∞ -->
            <div class="upgrade-item" data-id="chef">
                <img src="images/chef_upgrade.png" class="upgrade-icon" alt="üë®‚Äçüç≥">
                <div class="upgrade-info">
                    <div class="upgrade-title">–ü–æ–≤–∞—Ä</div>
                    <div class="upgrade-price">–¶–µ–Ω–∞: 50 –ø–æ–Ω—á–∏–∫–æ–≤</div>
                </div>
                <div class="upgrade-status">0</div>
            </div>
        </div>
        
        <!-- –°–õ–û–ô 2: –ú–ê–†–ö–ï–¢ –ö–ê–†–¢–û–ß–ï–ö -->
        <div id="card-upgrades-layer" style="display: none;">
            <div class="market-title">üõí –ú–∞—Ä–∫–µ—Ç –∫–∞—Ä—Ç–æ—á–µ–∫</div>
            <div class="coming-soon">–°–∫–æ—Ä–æ –∑–¥–µ—Å—å –ø–æ—è–≤—è—Ç—Å—è –∫—Ä—É—Ç—ã–µ –∫–∞—Ä—Ç–æ—á–∫–∏! üé¥</div>
        </div>
        
        <!-- –ö–Ω–æ–ø–∫–∞ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è -->
        <img id="open-upgrades-btn" src="images/upgrade_button.png" class="upgrades-action-btn" alt="‚û°Ô∏è">
    </div>
    
    <!-- Info-—Å–µ–∫—Ü–∏—è -->
    <div class="info-section">
        <img id="upgrade-info-btn" src="images/info_icon.png" class="info-btn" alt="‚ÑπÔ∏è">
        <div id="upgrade-details" class="info-text" style="display: none;"></div>
    </div>
</div>
    <script>
    // === –û–¢–õ–ê–î–ö–ê ===
    console.log('=== DONUT TAP DEBUG ===');
    console.log('üç© –í–µ—Ä—Å–∏—è: 0.8');
    console.log('üì¶ localStorage –¥–æ—Å—Ç—É–ø–µ–Ω:', typeof localStorage !== 'undefined');
    console.log('üë§ –¢–µ–∫—É—â–∏–π ID –≤ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ:', localStorage.getItem('donutTap_playerID'));
    
    // === –ö–û–ù–°–¢–ê–ù–¢–´ –ò –ü–ï–†–ï–ú–ï–ù–ù–´–ï ===
    let score = 0;
    let musicEnabled = true;
    let soundsEnabled = true;
    
    let upgrades = {
        chef: { 
            owned: 0,
            basePrice: 50,
            production: 4
        }
    };
    
    let passiveIncome = 0;
    let lastSaveTime = Date.now();
    
    const scoreDisplay = document.getElementById("score-text");
    const donut = document.getElementById("donut");
    const DONUT_SPRITE_URL = "url('./images/donut_sprite.png')";

    // === –°–ò–°–¢–ï–ú–ê –ü–ï–†–ï–ö–õ–Æ–ß–ï–ù–ò–Ø –ú–ï–ñ–î–£ –£–õ–£–ß–®–ï–ù–ò–Ø–ú–ò –ò –ú–ê–†–ö–ï–¢–û–ú ===
    document.getElementById('open-upgrades-btn').addEventListener('click', function() {
        const upgradesList = document.getElementById('upgrades-list');
        const cardLayer = document.getElementById('card-upgrades-layer');
        const btn = document.getElementById('open-upgrades-btn');
        
        if (upgradesList.style.display !== 'none') {
            upgradesList.style.display = 'none';
            cardLayer.style.display = 'block';
            btn.src = 'images/back_button.png';
        } else {
            upgradesList.style.display = 'block';
            cardLayer.style.display = 'none';
            btn.src = 'images/upgrade_button.png';
        }
    });

    // === –§–£–ù–ö–¶–ò–Ø –°–ë–†–û–°–ê –°–û–•–†–ê–ù–ï–ù–ò–ô ===
    function clearSave() {
        score = 0;
        document.getElementById("score-text").textContent = "0";
        upgrades.chef.owned = 0;
        passiveIncome = 0;
        
        localStorage.removeItem("donutTap_score");
        localStorage.removeItem("donutTap_upgrades");
        localStorage.removeItem("donutTap_lastSaveTime");
        localStorage.removeItem("donutTap_music");
        localStorage.removeItem("donutTap_sounds");
        
        updateUpgradesDisplay();
        calculatePassiveIncome();
        musicEnabled = true;
        soundsEnabled = true;
        updateSettingsIcons();
    }

    function fullReset() {
        if(confirm("–í—ã —Ç–æ—á–Ω–æ —Ö–æ—Ç–∏—Ç–µ —Å–±—Ä–æ—Å–∏—Ç—å –≤–µ—Å—å –ø—Ä–æ–≥—Ä–µ—Å—Å? –≠—Ç–æ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å!")) {
            clearSave();
            alert("–ü—Ä–æ–≥—Ä–µ—Å—Å –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–±—Ä–æ—à–µ–Ω! –°—Ç—Ä–∞–Ω–∏—Ü–∞ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—Å—è.");
            setTimeout(() => location.reload(), 1000);
        }
    }
    
    function formatNumber(num) {
        if (num < 1000) return num.toString();
        const suffixes = ["", "K", "M", "B", "T", "Qa", "Qi"];
        const tier = Math.floor(Math.log10(num) / 3);
        if (tier >= suffixes.length) return "‚àû";
        const scaled = num / Math.pow(1000, tier);
        const formatted = scaled % 1 === 0 ? scaled.toFixed(0) : scaled.toFixed(1);
        return formatted + suffixes[tier];
    }

    function calculatePassiveIncome() {
        passiveIncome = upgrades.chef.owned * upgrades.chef.production;
        return passiveIncome;
    }

    function updatePassiveIncome() {
        if (passiveIncome > 0) {
            score += passiveIncome;
            scoreDisplay.textContent = formatNumber(score);
            saveProgress();
        }
    }

    function buyUpgrade(upgradeId) {
        const upgrade = upgrades[upgradeId];
        const price = Math.floor(upgrade.basePrice * Math.pow(1.15, upgrade.owned));
        
        if (score >= price) {
            score -= price;
            upgrade.owned++;
            scoreDisplay.textContent = formatNumber(score);
            updateUpgradesDisplay();
            calculatePassiveIncome();
            saveProgress();
            saveUpgrades();
        }
    }

    function updateUpgradesDisplay() {
        const chefUpgrade = document.querySelector('[data-id="chef"]');
        if (chefUpgrade) {
            const chef = upgrades.chef;
            const nextPrice = Math.floor(chef.basePrice * Math.pow(1.15, chef.owned));
            
            chefUpgrade.querySelector('.upgrade-status').textContent = chef.owned;
            chefUpgrade.querySelector('.upgrade-price').textContent = `–¶–µ–Ω–∞: ${formatNumber(nextPrice)}`;
            
            const canAfford = score >= nextPrice;
            chefUpgrade.style.opacity = canAfford ? '1' : '0.6';
        }
    }

    function showUpgradeInfo() {
        const details = document.getElementById('upgrade-details');
        const chef = upgrades.chef;
        const totalProduction = chef.owned * chef.production;
        const nextPrice = Math.floor(chef.basePrice * Math.pow(1.15, chef.owned));
        
        details.innerHTML = `
            <strong>üç© –ü–æ–≤–∞—Ä</strong><br>
            –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç: ${chef.production} –ø–æ–Ω—á–∏–∫–æ–≤/—Å–µ–∫<br>
            –ö—É–ø–ª–µ–Ω–æ: ${chef.owned} –ø–æ–≤–∞—Ä–æ–≤<br>
            –í—Å–µ–≥–æ: +${totalProduction} –ø–æ–Ω—á–∏–∫–æ–≤/—Å–µ–∫<br>
            –°–ª–µ–¥—É—é—â–∏–π: ${formatNumber(nextPrice)} –ø–æ–Ω—á–∏–∫–æ–≤
        `;
        
        details.style.display = details.style.display === 'none' ? 'block' : 'none';
    }

    function calculateOfflineProgress() {
        const currentTime = Date.now();
        const savedTime = localStorage.getItem("donutTap_lastSaveTime");
        
        if (savedTime) {
            const offlineTime = currentTime - parseInt(savedTime);
            const offlineSeconds = Math.floor(offlineTime / 1000);
            const maxOfflineSeconds = 86400;
            const actualOfflineSeconds = Math.min(offlineSeconds, maxOfflineSeconds);
            
            if (actualOfflineSeconds > 0 && passiveIncome > 0) {
                const offlineDonuts = passiveIncome * actualOfflineSeconds;
                if (offlineDonuts > 0) {
                    score += offlineDonuts;
                    scoreDisplay.textContent = formatNumber(score);
                    saveProgress();
                    console.log(`üïí –û—Ñ—Ñ–ª–∞–π–Ω-–ø—Ä–æ–≥—Ä–µ—Å—Å: +${formatNumber(offlineDonuts)} –ø–æ–Ω—á–∏–∫–æ–≤ –∑–∞ ${formatTime(actualOfflineSeconds)}`);
                }
            }
        }
        lastSaveTime = currentTime;
    }

    function formatTime(seconds) {
        if (seconds < 60) return `${seconds} —Å–µ–∫`;
        if (seconds < 3600) return `${Math.floor(seconds / 60)} –º–∏–Ω`;
        if (seconds < 86400) return `${Math.floor(seconds / 3600)} —á–∞—Å`;
        return `${Math.floor(seconds / 86400)} –¥–Ω`;
    }

    function loadSave() {
    console.log('üîÑ –ó–∞–≥—Ä—É–∑–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è...');
    
    // 1. –¢–û–õ–¨–ö–û –ø–æ–∫–∞–∑—ã–≤–∞–µ–º ID (–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —É–∂–µ –≤—Å—Ç—Ä–æ–µ–Ω–æ –≤ –∫–ª–∏–∫)
    displayPlayerID(); // –£–±—Ä–∞–ª–∏ setupIDCopyButton()
    
    // 2. –ó–∞–≥—Ä—É–∂–∞–µ–º —Å—á–µ—Ç
    const savedScore = localStorage.getItem("donutTap_score");
    if (savedScore) {
        score = parseInt(savedScore);
        scoreDisplay.textContent = formatNumber(score);
    }
        
        const savedMusic = localStorage.getItem("donutTap_music");
        const savedSounds = localStorage.getItem("donutTap_sounds");
        
        musicEnabled = savedMusic !== null ? savedMusic === 'true' : true;
        soundsEnabled = savedSounds !== null ? savedSounds === 'true' : true;
        
        updateSettingsIcons();
        loadUpgrades();
        calculateOfflineProgress();
    }
       
    function saveProgress() {
        localStorage.setItem("donutTap_score", score.toString());
        localStorage.setItem("donutTap_lastSaveTime", Date.now().toString());
    }
    
    function saveSettings() {
        localStorage.setItem("donutTap_music", musicEnabled.toString());
        localStorage.setItem("donutTap_sounds", soundsEnabled.toString());
    }
    
    function saveUpgrades() {
        localStorage.setItem("donutTap_upgrades", JSON.stringify(upgrades));
    }
    
    function loadUpgrades() {
        const saved = localStorage.getItem("donutTap_upgrades");
        if (saved) {
            try {
                upgrades = JSON.parse(saved);
                calculatePassiveIncome();
                updateUpgradesDisplay();
            } catch (e) {
                console.log("–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —É–ª—É—á—à–µ–Ω–∏–π, —Å–±—Ä–æ—Å...");
                clearSave();
            }
        }
    }
    
    function updateSettingsIcons() {
        const musicIcon = document.getElementById("music-icon");
        const soundIcon = document.getElementById("sound-icon");
        musicIcon.src = musicEnabled ? 'images/music_on.png' : 'images/music_off.png';
        soundIcon.src = soundsEnabled ? 'images/sound_on.png' : 'images/sound_off.png';
    }

    function createParticle(x, y) {
        const container = document.getElementById('particles-container');
        const particle = document.createElement('div');
        
        particle.className = 'particle';
        particle.style.backgroundImage = DONUT_SPRITE_URL;
        particle.style.left = (x - 16) + 'px';
        particle.style.top = (y - 16) + 'px';
        
        const angle = Math.random() * Math.PI * 2;
        const distance = 50 + Math.random() * 80;
        const targetX = x + Math.cos(angle) * distance;
        const targetY = y + Math.sin(angle) * distance;
        
        container.appendChild(particle);
        
        setTimeout(() => {
            particle.style.transform = `translate(${targetX - x}px, ${targetY - y}px)`;
            particle.style.opacity = '0';
        }, 10);
        
        setTimeout(() => {
            if (particle.parentNode) {
                particle.parentNode.removeChild(particle);
            }
        }, 500);
    }

    const tapSounds = [
        'sounds/tap1.mp3',
        'sounds/tap2.mp3',
        'sounds/tap3.mp3',
        'sounds/tap4.mp3',
        'sounds/tap5.mp3',
        'sounds/tap6.mp3',
        'sounds/tap7.mp3'
    ];

    function playTapSound() {
        if (!soundsEnabled) return;
        
        const randomSound = tapSounds[Math.floor(Math.random() * tapSounds.length)];
        const audio = new Audio(randomSound);
        audio.volume = 0.3;
        audio.play().catch(e => {
            console.log("Audio play failed:", e);
            soundsEnabled = false;
            saveSettings();
            updateSettingsIcons();
        });
    }

    function tap(event) {
        score++;
        scoreDisplay.textContent = formatNumber(score);
        saveProgress();
        
        donut.classList.remove("jump-animation");
        void donut.offsetWidth;
        donut.classList.add("jump-animation");
        
        createParticle(event.clientX, event.clientY);
        playTapSound();
    }

    function generatePlayerID() {
        try {
            const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
            let result = 'DT_';
            
            const timestamp = Date.now().toString().slice(-4);
            
            for (let i = 0; i < 4; i++) {
                result += chars.charAt(Math.floor(Math.random() * chars.length));
            }
            
            result += timestamp;
            console.log('‚ú® –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω ID:', result);
            return result;
        } catch (error) {
            return 'DT_' + Math.random().toString(36).substr(2, 8).toUpperCase();
        }
    }

    function getPlayerID() {
        try {
            let playerID = localStorage.getItem('donutTap_playerID');
            
            if (!playerID || playerID.length < 5) {
                console.log('üÜî –°–æ–∑–¥–∞–µ–º –Ω–æ–≤—ã–π ID –∏–≥—Ä–æ–∫–∞...');
                playerID = generatePlayerID();
                localStorage.setItem('donutTap_playerID', playerID);
            }
            
            if (!playerID.startsWith('DT_')) {
                console.log('‚ö†Ô∏è –ò—Å–ø—Ä–∞–≤–ª—è–µ–º —Å—Ç–∞—Ä—ã–π —Ñ–æ—Ä–º–∞—Ç ID...');
                playerID = generatePlayerID();
                localStorage.setItem('donutTap_playerID', playerID);
            }
            
            return playerID;
        } catch (error) {
            console.log('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ ID:', error);
            return 'DT_GUEST001';
        }
    }

    function displayPlayerID() {
    try {
        console.log('üîç –ù–∞—á–∏–Ω–∞–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ ID –∏–≥—Ä–æ–∫–∞...');
        const playerID = getPlayerID();
        const displayElement = document.getElementById('player-id-display');
        
        if (displayElement) {
            displayElement.textContent = playerID;
            displayElement.classList.add('clickable-id');
            console.log('‚úÖ ID –æ—Ç–æ–±—Ä–∞–∂–µ–Ω:', playerID);
            
            // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–∞ –¥–ª—è –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è
            displayElement.addEventListener('click', copyIDOnClick);
        } else {
            console.log('‚ùå –≠–ª–µ–º–µ–Ω—Ç #player-id-display –Ω–µ –Ω–∞–π–¥–µ–Ω!');
            setTimeout(displayPlayerID, 100);
        }
    } catch (error) {
        console.log('üí• –û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–∏ ID:', error);
    }
}

function copyIDOnClick() {
    const playerID = getPlayerID();
    const displayElement = document.getElementById('player-id-display');
    
    navigator.clipboard.writeText(playerID).then(() => {
        console.log('üìã ID —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω:', playerID);
        
        // –ü—Ä–æ—Å—Ç–∞—è –∞–Ω–∏–º–∞—Ü–∏—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è
        if (displayElement) {
            displayElement.classList.add('copied-animation');
            
            const originalText = displayElement.textContent;
            displayElement.textContent = '–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!';
            
            setTimeout(() => {
                displayElement.textContent = originalText;
                displayElement.classList.remove('copied-animation');
            }, 1500);
        }
        
    }).catch(err => {
        console.log('‚ùå –û—à–∏–±–∫–∞ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è:', err);
        
        // Fallback –¥–ª—è —Å—Ç–∞—Ä—ã—Ö –±—Ä–∞—É–∑–µ—Ä–æ–≤
        const textArea = document.createElement('textarea');
        textArea.value = playerID;
        document.body.appendChild(textArea);
        textArea.select();
        document.execCommand('copy');
        document.body.removeChild(textArea);
        
        if (displayElement) {
            displayElement.textContent = '–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!';
            setTimeout(() => displayElement.textContent = playerID, 1500);
        }
    });
}
   
    // === –û–ë–†–ê–ë–û–¢–ß–ò–ö–ò –°–û–ë–´–¢–ò–ô ===
    document.getElementById('settings-btn').addEventListener('click', () => {
        document.getElementById('settings-modal').style.display = 'block';
    });

    document.getElementById('close-btn').addEventListener('click', () => {
        document.getElementById('settings-modal').style.display = 'none';
    });

    document.getElementById('music-setting').addEventListener('click', () => {
        musicEnabled = !musicEnabled;
        saveSettings();
        updateSettingsIcons();
    });

    document.getElementById('sound-setting').addEventListener('click', () => {
        soundsEnabled = !soundsEnabled;
        saveSettings();
        updateSettingsIcons();
    });
    
    document.getElementById('reset-btn-settings').addEventListener('click', fullReset);
    
    document.getElementById('upgrades-btn').addEventListener('click', function() {
    document.getElementById('upgrades-layer').style.display = 'block';
    updateUpgradesDisplay();
    
    // –ü—Ä–æ–∫—Ä—É—á–∏–≤–∞–µ–º –∫ –Ω–∞—á–∞–ª—É —Å–ø–∏—Å–∫–∞
    const upgradesList = document.getElementById('upgrades-list');
    if (upgradesList) {
        upgradesList.scrollTop = 0;
    }
});
    
    document.getElementById('close-upgrades').addEventListener('click', function() {
        document.getElementById('upgrades-layer').style.display = 'none';
        document.getElementById('upgrade-details').style.display = 'none';
    });

    document.querySelector('[data-id="chef"]').addEventListener('click', function() {
        buyUpgrade('chef');
    });

    document.getElementById('upgrade-info-btn').addEventListener('click', showUpgradeInfo);

    window.addEventListener('beforeunload', function() {
        saveProgress();
    });

    // === –ó–ê–ü–£–°–ö –ò–ì–†–´ ===
    donut.addEventListener("click", tap);
    loadSave();
    setInterval(updatePassiveIncome, 1000);
</script>
    </body>
            </html>
